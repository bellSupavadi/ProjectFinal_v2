<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <!-- Popper JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <!-- Latest compiled JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

  <!-- <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
    <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
  <title>Document</title>
  
  <link rel="stylesheet" href="style.css">
  <script src="ejs.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-app.js"></script>

  <!-- Add Firebase products that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-firestore.js"></script>
  <script>
        // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyDoHO89lanbk1_OqG9oBPSRYkYhc5OpHlw",
    authDomain: "testproject-f89be.firebaseapp.com",
    databaseURL: "https://testproject-f89be.firebaseio.com",
    projectId: "testproject-f89be",
    storageBucket: "testproject-f89be.appspot.com",
    messagingSenderId: "282046642874",
    appId: "1:282046642874:web:c4de5e6851594a6b"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  var db = firebase.firestore();
    </script>
</head>

<body>
  <nav class="navbar navbar-expand-md navbar-light bg-light fixed-top">
      <a class="navbar-brand" href="index.html">
          <img src="photo/MFR.png" style="width:50px;">
        </a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
      aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav ml-auto">
          <li class="nav-item">
              <a class="nav-link" href="home.html">HOME</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">RENT</a>
              </li>
              
        <li class="nav-item">
          <a class="nav-link" href="about.html">ABOUT</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" onclick="logout()">LOGOUT</a>
        </li>
      </ul>
      <a class="btn btn-outline-success my-2 my-sm-0" href="shopowner.html">SHOP</a>
      
    </div>
  </nav>
  <section class="container-fluid_main2">
    <p>PHUKET WELCOME</p>
   
   
      <div class="main">
          <div class="form-group icon-in-right">
              <span class="fa fa-search icon text-primary"></span>
              <input type="text" class="form-control effect naranja redondo" placeholder="Search">
            </div>
          </div>
  </section>
  </div>
 
 
     
    <div class="container">
     
      <br>
      <div class="row" >
     
        
      
      
       
    <div class="card-deck" id="size"  >
     </div>
          </div>
        </div> 
      </div>
  <section id="credit">
    <p>Made with <a href="https://www.paypal.me/connorocampo" target="_blank"><i class="fas fa-heart"></i></a> by <a
        href="https://www.paypal.me/connorocampo" target="_blank">Connor Ocampo</a></p>
  </section>
</div>


 <!-- Modal -->
 <div class="modal fade" id="elegantModalForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
 aria-hidden="true">
 <div class="modal-dialog" role="document">
   <!--Content-->
   <div class="modal-content form-elegant">
     <!--Header-->
     <div class="modal-header text-center">
       <h3 class="modal-title w-100 dark-grey-text font-weight-bold my-3" id="myModalLabel"><strong>เวลาที่ต้องการจอง</strong></h3>
       <button type="button" class="close" data-dismiss="modal" aria-label="Close">
         <span aria-hidden="true">&times;</span>
       </button>
     </div>
     <!--Body-->
     <div class="modal-body mx-4">
       <!--Body-->
       <div class="modal-body md-form mb-5">
         <input type="text"  class="form-control validate"id="startDate">
         <label data-error="wrong" data-success="right" >วันที่</label>
       </div>

       <div class="modal-body md-form pb-3">
         <input type="text"  class="form-control validate"id="endDate">
         <label data-error="wrong" data-success="right" >ถึง</label>

       </div>

       <div class="modal-body text-center mb-3">
          <a onclick="sendtoshop()" class="btn btn-primary stretched-link">ดูราคา</a>
          <div class="text-center"> 


   </div>

 </div>
 </div>
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
 
 
</body>
<script>

var uid =localStorage.getItem("id");
console.log(uid);
  var userid
 firebase.auth().onAuthStateChanged(function(user) {
   if (user) {
     // User is signed in.
     userid=user.uid
     // ...
   } else {
     // User is signed out.
     window.location.href="index"
     // ...
   }
 });


allshop()
    function allshop() {
        var html=''
        db.collection("shop").get()
                .then(function (querySnapshot) {
                    // doc.data() is never undefined for query doc snapshots
                 
                    querySnapshot.docs.forEach(function(data) {
                        console.log(data.id);
                        
                       html += '<div class="col-sm-4">'+'<br>'+'<div class="card" >'+
          '<img class="card-img-top" src="'+data.data().picshop+'" alt="Card image">'+
        '<div class="card-body">'+
         ' <h4 class="card-title">'+data.data().shopname+'</h4>'+
          '<p class="card-text">Some example text some example text. John Doe is an architect and engineer</p>'+
          
          '<a onclick="sendToherf('+"'"+data.id+"'"+')" class="btn btn-default btn-rounded" data-toggle="modal" data-target="#elegantModalForm">'+
              'Detail</a>'+
            '</div>'+'</div>'+
        '</div>'
                   });
                   document.getElementById("size").innerHTML = html;
                  //  console.log(html);
                   
                })
                .catch(function (error) {
                    console.log("Error getting documents: ", error);
                });

    }
    function sendToherf(shopid) {
      console.log(shopid);
        localStorage.setItem("shopid",shopid);
        
        
    // window.location.href='shopdetail.html'
    }
    var today = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate());
        $('#startDate').datepicker({
            uiLibrary: 'bootstrap4',
            iconsLibrary: 'fontawesome',
            minDate: today,
            maxDate: function () {
                return $('#endDate').val();
            }
        });
        $('#endDate').datepicker({
            uiLibrary: 'bootstrap4',
            iconsLibrary: 'fontawesome',
            minDate: function () {
                return $('#startDate').val();
            }
        });
        function sendtoshop() {
          var start=document.getElementById('startDate').value;
          var end=document.getElementById('endDate').value;
          //var date={'start':start,'end':end}
          console.log(start,end);
          localStorage.setItem("start",start);
          
          localStorage.setItem("end",end);
     window.location.href='shopdetail.html'
        }


/////////////////////////////////////////////////////distance/////////////////////////////////////////////////////////////////////
console.log(getDistanceFromLatLonInKm(18.3170581,99.3986862,18.3170581,99.3976862));


        function getDistanceFromLatLonInKm(lat1,lon1,lat2,lon2) {
  var R = 6371; // Radius of the earth in km
  var dLat = deg2rad(lat2-lat1);  // deg2rad below
  var dLon = deg2rad(lon2-lon1); 
  var a = 
    Math.sin(dLat/2) * Math.sin(dLat/2) +
    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * 
    Math.sin(dLon/2) * Math.sin(dLon/2)
    ; 
  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
  var d = R * c; // Distance in km
  return d;
}

function deg2rad(deg) {
  return deg * (Math.PI/180)
}

function logout(){
  localStorage.clear()
    firebase.auth().signOut().then(function() {
        window.location.href='index.html'
     
}).catch(function(error) {
// An error happened.
});
 }
</script>
</html>