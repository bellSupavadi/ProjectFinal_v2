<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!-- jQuery library -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/air-datepicker/2.2.3/css/datepicker.css">
    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Nunito:400,600,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href=" https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet"
        href="https://maxcdn.icons8.com/fonts/line-awesome/1.1/css/line-awesome-font-awesome.min.css">

    <script src='https://kit.fontawesome.com/a076d05399.js'></script>
    <title>Document</title>
    <script src="calender.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="calender.css">
</head>
<script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-app.js"></script>

<!-- Add Firebase products that you want to use -->
<script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.1.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.7.0/firebase-storage.js"></script>
<script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
        apiKey: "AIzaSyDoHO89lanbk1_OqG9oBPSRYkYhc5OpHlw",
        authDomain: "testproject-f89be.firebaseapp.com",
        databaseURL: "https://testproject-f89be.firebaseio.com",
        projectId: "testproject-f89be",
        storageBucket: "testproject-f89be.appspot.com",
        messagingSenderId: "282046642874",
        appId: "1:282046642874:web:c4de5e6851594a6b"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var storage = firebase.storage();
</script>

<body>
    <nav class="navbar navbar-expand-md navbar-light bg-light fixed-top">


        <a class="navbar-brand" href="index.html">
            <img src="photo/MFR.png" style="width:50px;">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
            aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav ml-auto">

                <li class="nav-item">
                    <a class="nav-link" href="shop.html">RENT</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="about.html">ABOUT</a>
                </li>

                <li class="nav-item">
                    <a class="btn btn-outline-success my-2 my-sm-0" href="shopowner.html">SHOP</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="logout()">LOGOUT</a>
                </li>
            </ul>
        </div>
    </nav>
    <br>
    <div class="container">
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a href="#tab1" data-toggle="tab" class="nav-link active">รายละเอียดร้าน</a>
            </li>
            <li class="nav-item">
                <a href="#tab2" data-toggle="tab" class="nav-link">รายการรถ</a>
            </li>
            <li class="nav-item">
                <a href="#tab3" data-toggle="tab" class="nav-link">ข้อมูลบัญชีธนาคาร</a>
            </li>
            <li class="nav-item">
                <a href="#tab4" data-toggle="tab" class="nav-link">รายงานของร้าน</a>
            </li>
        </ul>
        <div class="tab-content py-3">
            <div class="tab-pane active" id="tab1" style="display: none;">
                <div class="avatar-upload">
                    <div class="avatar-edit">
                        <input type='file' id="imageUpload" accept=".png, .jpg, .jpeg" />
                        <label for="imageUpload"></label>
                    </div>
                    <div class="avatar-preview">
                        <div id="imagePreview" style="background-image: url(http://i.pravatar.cc/500?img=7);">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <div class="col-sm-6">
                            <label for="">ชื่อร้าน</label>
                            <input type="text" class="form-control" name="shopname" id="shopname"
                                aria-describedby="helpId" placeholder="">
                        </div>
                        <div class="col-sm-6">
                            <label for="">ชื่อ-สกุล</label>
                            <input type="text" class="form-control" name="name" id="name" aria-describedby="helpId"
                                placeholder="">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <div class="col-sm-6">
                            <label for="">เบอร์โทรติดต่อ</label>
                            <input type="text" class="form-control" name="phone" id="phone" aria-describedby="helpId"
                                placeholder="">
                        </div>

                        <div class="col-sm-6">
                            <label for="">Email</label>
                            <input type="email" class="form-control" name="mail" id="mail" aria-describedby="helpId"
                                placeholder="">
                        </div>
                    </div>
                </div>


                <div class="form-group">
                    <label for="">ที่อยู่</label>
                    <textarea class="form-control" rows="5" id="address"></textarea>
                </div>
                <a class="btn btn-outline-primary" onclick="editshop()" id="edit">แก้ไข</a>

            </div>
            <div class="tab-pane" id="tab2">

                <a href="" class="btn btn-outline-danger" data-toggle="modal"
                    data-target="#elegantModalForm">เพิ่มรถ</a>

                <div class="container">
                    <div class="row">
                        <div class="card-deck col-12" id="bike">





                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane" id="tab3">
                <a href="" class="btn btn-outline-danger" data-toggle="modal" data-target="#elegantModalForm_bank"
                    id="addbanking">เพิ่มบัญชีธนาคาร</a>
                <div class="container" id="banking">

                </div>
            </div>
            <div class="tab-pane" id="tab4">
                <div class="p-3">
                    <center>
                        <h2 class="mb-4">Calendar</h2>
                    </center>
                    <!-- <div class="card">
                              <div class="card-body p-0"> -->
                    <div id="calendar"></div>
                    <!-- </div>
                            </div> -->
                </div>
                <!-- calendar modal -->
                <div id="modal-view-event" class="modal modal-top fade calendar-modal">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-body">
                                <h4 class="modal-title"><span class="event-icon"></span><span
                                        class="event-title"></span></h4>
                                <div class="event-body"></div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
        </div>

    </div>







    <!-- <section id="credit">
        <p>Motorcycle For Rent</p>
    </section> -->

    <!-- Modal -->
    <div class="modal fade" id="elegantModalForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true" style="padding: 200px; width: 100%;">
        <div class="modal-dialog" role="document">
            <!--Content-->
            <div class="modal-content form-elegant">
                <!--Header-->
                <div class="modal-header text-center">
                    <center>
                        <h3>รายละเอียดรถ</h3>
                    </center>

                    <!-- <span>กรุณาใส่รายละเอียดให้ครบถ้วน</span> -->
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <hr>
                </div>
                <!--Body-->
                <div class="modal-body mx-4">
                    <!--Body-->
                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-4">
                                <label for="">ยี่ห้อรถ</label>
                                <select class="form-control" name="" id="brand">
                                    <option>Honda</option>
                                    <option>Yamaha</option>
                                    <option>Fino</option>
                                </select></div>
                            <div class="col-sm-4">
                                <label for="">รุ่นรถ</label>
                                <select class="form-control" name="" id="type">
                                    <option>click</option>
                                    <option>scoopy</option>
                                    <option>Fino</option>
                                </select></div>
                            <div class="col-sm-4">
                                <label for="">color</label>
                                <select class="form-control" name="" id="color">
                                    <option>red</option>
                                    <option>blue</option>
                                    <option>green</option>
                                </select></div>
                        </div>

                    </div>


                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-4">
                                <label for="">รุ่นปีรถ</label>
                                <select class="form-control" name="" id="typeyear">
                                    <option>2019</option>
                                    <option>2018</option>
                                    <option>2017</option>
                                </select></div>
                            <div class="col-sm-4">
                                <label for="">ขนาดเครื่องยนต์</label>
                                <input type="text" class="form-control" name="" id="motor" aria-describedby="helpId"
                                    placeholder="300 CC">

                            </div>
                            <div class="col-sm-4">
                                <label for="">แบบเครื่องยนต์</label>
                                <input type="text" class="form-control" name="" id="typemotor" aria-describedby="helpId"
                                    placeholder="4 จังหวะ">

                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">

                            <div class="col-sm-6">
                                <label for="">ประเภทเชื้อเพลิงที่ใช้เติม</label>
                                <input type="text" class="form-control" name="" id="typegass" aria-describedby="helpId"
                                    placeholder="เบนซิน 91">

                            </div>
                            <div class="col-sm-6">
                                <label for="">ราคาเช่าต่อวัน</label>
                                <input type="text" class="form-control" name="" id="price" aria-describedby="helpId"
                                    placeholder="300 ">

                            </div>
                        </div>
                    </div>


                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-6">
                                <label for="">กี่คัน</label>
                                <input type="number" class="form-control" name="" id="count" aria-describedby="helpId"
                                    placeholder="300 ">

                            </div>
                            <div class="col-sm-6">
                                <label for="">ระบบเกียร์</label><br>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="Radios" id="Radios1"
                                        value="option1">
                                    <label class="form-check-label" for="Radios1">
                                        Automatic
                                    </label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="Radios" id="Radios2"
                                        value="option2">
                                    <label class="form-check-label" for="Radios2">
                                        Maual
                                    </label>
                                </div>

                            </div>
                        </div>
                    </div>



                    <div class="col-md-10">
                        <div class="form-group">
                            <label>อัพโหลดรูปภาพรถ</label>
                            <div class="input-group">
                                <span class="input-group-btn">
                                    <span class="btn btn-default btn-file">
                                        เลือกรูป.. <input type="file" id="files">
                                    </span>
                                </span>
                                <input type="text" class="form-control" readonly>
                            </div>
                            <center><img id='img-upload' /></center>
                        </div>
                        <center> <a href="#" class="btn btn-primary" onclick="addpic()">บันทึก</a></center>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Bank-->

    </div>
    <div class="modal fade" id="elegantModalForm_bank" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true" style="padding: 200px;">
        <div class="modal-dialog" role="document">
            <!--Content-->
            <div class="modal-content form-elegant">
                <!--Header-->
                <div class="modal-header text-center">
                    <center>
                        <h3>รายละเอียดบัญชี</h3>
                    </center>

                    <!-- <span>กรุณาใส่รายละเอียดให้ครบถ้วน</span> -->
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <hr>
                </div>
                <!--Body-->
                <div class="modal-body mx-4">
                    <!--Body-->
                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-6">
                                <label for="">ธนาคาร</label>
                                <select class="form-control" name="" id="bank">
                                    <option>bbl</option>
                                    <option>kbank</option>
                                    <option>ktb</option>
                                    <option>scb</option>
                                    <!-- <option>ธนาคารไทยพาณิชย์ จำกัด (มหาชน)</option> -->

                                </select></div>
                            <div class="col-sm-6">
                                <label for="">สาขา</label>
                                <input type="text" class="form-control" name="" id="major" aria-describedby="helpId"
                                    placeholder="ภูเก็ต">

                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-sm-6">
                                    <label for="">ชื่อบัญชี</label>
                                    <input type="text" class="form-control" name="" id="namebank"
                                        aria-describedby="helpId" placeholder="นายเช่า  ได้นะ">

                                </div>
                                <div class="col-sm-6">
                                    <label for="">หมายเลขบัญชี</label>
                                    <input type="text" class="form-control" name="" id="numbank"
                                        aria-describedby="helpId" placeholder="123-456459-8">

                                </div>
                            </div>
                        </div>
                        <a href="#" class="btn btn-primary" id="createbank" onclick="createreciept()">บันทึก</a>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script> -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script> -->

    <script src="https://cdn.omise.co/omise.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.min.js"></script>


    <script>
        firebase.auth().onAuthStateChanged(function (user) {
            if (user) {
                // User is signed in.
                email = user.email
                uid = user.uid
                showdetailshop()
                // ...
            } else {
                // User is signed out.
                window.location.href = "index.html"
                // ...
            }
        });
        // wire up shown event
        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            console.log(e.currentTarget.hash);
            if (e.currentTarget.hash == "#tab1") {
                showdetailshop()
            }
            else if (e.currentTarget.hash == "#tab2") {

                showshopbikedetail()
            }
            else if (e.currentTarget.hash == "#tab3") {

                checkbank();
            }
            else if (e.currentTarget.hash == "#tab4") {

                tong();
            }
        });
        // read hash from page load and change tab
        var hash = document.location.hash;
        console.log(hash);

        var prefix = "tab_";
        if (hash) {
            $('.nav-tabs a[href="' + hash.replace(prefix, "") + '"]').tab('show');
        }


        var email
        var uid
        var pic = ''
        var pic2 = ''
        var shopid
        var nameandlastname


        function showdetailshop() {

            db.collection("shop").where("UID", "==", uid).get()
                .then(function (querySnapshot) {
                    // doc.data() is never undefined for query doc snapshots
                    querySnapshot.docs.forEach(function (data) {
                        shopid = data.id
                        nameandlastname = data.data().name
                        document.getElementById('tab1').removeAttribute('style')

                        document.getElementById('imagePreview').setAttribute('style', "background-image: url(" + data.data().picshop + ");")
                        document.getElementById("shopname").value = data.data().shopname;
                        document.getElementById('shopname').setAttribute("disabled", false)
                        document.getElementById("phone").value = data.data().phone;
                        document.getElementById('phone').setAttribute("disabled", false)
                        document.getElementById("mail").value = email;
                        document.getElementById('mail').setAttribute("disabled", false)
                        document.getElementById("name").value = data.data().name;
                        document.getElementById('name').setAttribute("disabled", false)
                        document.getElementById("address").value = data.data().address;
                        document.getElementById('address').setAttribute("disabled", false)
                        document.getElementById('edit').setAttribute("onclick", 'editshop()')
                        $("#edit").text('edit');


                    });

                })
                .catch(function (error) {
                    console.log("Error getting documents: ", error);
                });


        }




        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $('#imagePreview').css('background-image', 'url(' + e.target.result + ')');
                    // $('#imagePreview').hide();
                    // $('#imagePreview').fadeIn(650);
                    console.log(input.files[0]);



                    //function to save file

                    console.log(email);


                    var file = input.files[0]
                    console.log(file);

                    // Create a storage reference from our storage service
                    var storageRef = storage.ref();


                    //dynamically set reference to the file name
                    var thisRef = storageRef.child('license/' + file.name);
                    console.log(thisRef);

                    //put request upload file to firebase storage
                    thisRef.put(file).then(function (snapshot) {
                        console.log('5555');
                        //get request to get URL for uploaded file
                        thisRef.getDownloadURL().then(function (url) {
                            // Insert url into an <img> tag to "download"
                            console.log(url);

                            pic = url
                        }).catch(function (error) {

                            // A full list of error codes is available at
                            // https://firebase.google.com/docs/storage/web/handle-errors
                            switch (error.code) {
                                case 'storage/object-not-found':
                                    // File doesn't exist
                                    break;

                                case 'storage/unauthorized':
                                    // User doesn't have permission to access the object
                                    break;

                                case 'storage/canceled':
                                    // User canceled the upload
                                    break;



                                case 'storage/unknown':
                                    // Unknown error occurred, inspect the server response
                                    break;
                            }
                        });
                    });




                }
                reader.readAsDataURL(input.files[0]);


            }
        }
        $("#imageUpload").change(function () {
            readURL(this);
        });


        $(document).ready(function () {
            $(document).on('change', '.btn-file :file', function () {
                var input = $(this),
                    label = input.val().replace(/\\/g, '/').replace(/.*\//, '');
                input.trigger('fileselect', [label]);
            });
            $('.btn-file :file').on('fileselect', function (event, label) {
                var input = $(this).parents('.input-group').find(':text'),
                    log = label;
                if (input.length) {
                    input.val(log);
                } else {
                    if (log) alert(log);
                }
            });
            function readURL(input) {
                if (input.files && input.files[0]) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        $('#img-upload').attr('src', e.target.result);
                    }
                    reader.readAsDataURL(input.files[0]);
                }
            }
            $("#imgInp").change(function () {
                readURL(this);
            });
        });
        function editshop() {
            document.querySelector('#shopname').removeAttribute("disabled")

            document.querySelector('#phone').removeAttribute("disabled")

            document.querySelector('#mail').removeAttribute("disabled")

            document.querySelector('#name').removeAttribute("disabled")

            document.querySelector('#address').removeAttribute("disabled")
            document.querySelector('#edit').setAttribute("onclick", 'okshop()')
            $("#edit").text('บันทึก');

        }
        function okshop() {
            var phone = document.getElementById("phone").value
            var mail = document.getElementById("mail").value
            var name = document.getElementById("name").value
            var shopname = document.getElementById("shopname").value
            var address = document.getElementById("address").value
            db.collection("shop").where("UID", "==", uid).get()
                .then(function (querySnapshot) {

                    // doc.data() is never undefined for query doc snapshots
                    querySnapshot.docs.forEach(function (data) {
                        shopid = data.id
                        console.log(data.id);

                        db.collection("shop").doc(data.id).update({
                            shopname: shopname,
                            name: name,
                            email: mail,
                            phone: phone,
                            address: address,
                            picshop: pic,
                        });

                    });
                    showdetailshop()
                })
                .catch(function (error) {
                    console.log("Error getting documents: ", error);
                });
        }

        function showshopbikedetail() {
            document.getElementById('bike').innerHTML = ""

            db.collection("shop").where("UID", "==", uid).get()
                .then(function (querySnapshot) {
                    shopid = querySnapshot.docs[0].id
                    console.log(shopid);

                    // var html
                    // doc.data() is never undefined for query doc snapshots
                    querySnapshot.docs.forEach(function (data) {
                        console.log(data.id);

                        db.collection("bike").where("shopid", "==", data.id).get()
                            .then(function (querySnapshot) {
                                // doc.data() is never undefined for query doc snapshots
                                querySnapshot.docs.forEach(function (data) {
                                    console.log(data.data());
                                    //    var x = document.createElement("div");         // Create a text node

                                    var html =
                                        '<div class="col-sm-4">' + '<br>' +
                                        '<div class="card"><a href="detailOfmocy.html"></a>' +
                                        '<img class="card-img-top" src="' + data.data().picbike + '" id="Card image">' +
                                        '<div class="card-body">' +
                                        '<h4 class="card-title">' + data.data().type + '</h4>' +


                                        '</div>' +


                                        '<center> <a href="#" class="btn btn-primary stretched-link">ข้อมูลรถ</a>'
                                    '</center>'

                                    '</div>' +

                                        '</div>'
                                    // x.classList.add(html);
                                    // x.appendChild(html);
                                    $('#bike').append(html);                              // Append the text to <li>
                                    //document.getElementById("bike").appendChild(x);
                                });
                                //document.getElementById("bike").innerHTML=html;

                            })
                            .catch(function (error) {
                                console.log("Error getting documents: ", error);
                            });

                    });

                })
                .catch(function (error) {
                    console.log("Error getting documents: ", error);
                });
        }


        function addpic() {
            console.log(email);


            var file = document.getElementById("files").files[0];
            console.log(file);

            // Create a storage reference from our storage service
            var storageRef = storage.ref();


            //dynamically set reference to the file name
            var thisRef = storageRef.child('license/' + file.name);
            console.log(thisRef);

            //put request upload file to firebase storage
            thisRef.put(file).then(function (snapshot) {
                console.log('5555');
                //get request to get URL for uploaded file
                thisRef.getDownloadURL().then(function (url) {
                    // Insert url into an <img> tag to "download"
                    console.log(url);
                    pic2 = url
                    insertbike(pic2)



                }).catch(function (error) {

                    // A full list of error codes is available at
                    // https://firebase.google.com/docs/storage/web/handle-errors
                    switch (error.code) {
                        case 'storage/object-not-found':
                            // File doesn't exist
                            break;

                        case 'storage/unauthorized':
                            // User doesn't have permission to access the object
                            break;

                        case 'storage/canceled':
                            // User canceled the upload
                            break;



                        case 'storage/unknown':
                            // Unknown error occurred, inspect the server response
                            break;
                    }
                });
            });




        }


        function insertbike(pic) {
            var brand = document.getElementById("brand").value;
            var type = document.getElementById("type").value;
            var typeyear = document.getElementById("typeyear").value;
            var motor = document.getElementById("motor").value;
            var typemotor = document.getElementById("typemotor").value;
            var typegass = document.getElementById("typegass").value;
            var price = document.getElementById("price").value;
            var count = document.getElementById("count").value;
            var color = document.getElementById("color").value;
            console.log(brand, shopid, typeyear, shopid);

            db.collection("bike").add({
                shopid: shopid,
                brand: brand,
                type: type,
                typeyear: typeyear,
                motor: motor,
                typemotor: typemotor,
                typegass: typegass,
                price: price,
                count: count,
                color: color,
                picbike: pic

            })
                .then(function (docRef) {
                    console.log("Document written with ID: ", docRef.id);
                    showshopbikedetail()
                })
                .catch(function (error) {
                    console.error("Error adding document: ", error);
                });

        }

        function createreciept() {
            var bank = document.getElementById("bank").value;
            var major = document.getElementById("major").value;
            var numbank = document.getElementById("numbank").value;
            var namebank = document.getElementById("namebank").value;
            var bankobject = {
                name: namebank,
                email: email,
                type: 'individual',
                bank_account: {
                    brand: bank,
                    number: numbank,
                    name: namebank

                }
            }
            console.log(bankobject);
            var object = JSON.stringify(bankobject)
            $.ajax({
                type: "POST",
                url: "https://fierce-fortress-50416.herokuapp.com/recipent",
                data: object,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    console.log(data.data.id);
                    // $("#elegantModalForm").modal();

                    db.collection("bank").add({
                        bank: bank,
                        major: major,
                        numbank: numbank,
                        namebank: namebank,
                        shopid: shopid,
                        recipentid: data.data.id

                    })
                        .then(function (docRef) {
                            console.log("Document written with ID: ", docRef.id);
                            $("#elegantModalForm_bank").modal('hide')
                            $("#addbanking").text('แก้ไข');
                            document.querySelector('#createbank').setAttribute("onclick", 'editbank()')
                            showshopbikedetail()
                        })
                        .catch(function (error) {
                            console.error("Error adding document: ", error);
                        });







                    // localStorage.clear();
                },
                error: function (data) {
                    // $("#cross").modal();
                    // storebike=[]
                    console.log(data);

                    alert("fail");
                }
            });

        }
        function checkbank() {
            $("#banking").html("");
            console.log(shopid);

            db.collection("bank").where("shopid", "==", shopid).get()
                .then(function (querySnapshot) {
                    // doc.data() is never undefined for query doc snapshots
                    if (querySnapshot.docs = "") { } else {
                        querySnapshot.docs.forEach(function (data) {
                            var html = '<div class="card ">' +
                                '<img class="card-img-top" alt="">' +
                                '<div class="card-body">' +
                                '<h4 class="card-title">' + data.data().bank + '</h4>' +
                                '<p class="card-text">' + data.data().namebank + '</p>' +
                                '</div>' +
                                '</div>'
                            $("#banking").append(html);
                            document.getElementById("bank").value = data.data().bank;
                            //document.getElementById('bank').setAttribute("disabled", false)
                            document.getElementById("namebank").value = data.data().namebank;
                            //document.getElementById('namebank').setAttribute("disabled", false)
                            document.getElementById("numbank").value = data.data().numbank;
                            //document.getElementById('numbank').setAttribute("disabled", false)
                            document.getElementById("major").value = data.data().major;
                            // document.getElementById('major').setAttribute("disabled", false)
                            $("#addbanking").text('แก้ไข');
                            document.querySelector('#createbank').setAttribute("onclick", 'editbank()')
                            console.log("onclick");

                        });
                    }

                })
                .catch(function (error) {
                    console.log("Error getting documents: ", error);
                });
        }
        function editbank() {
            console.log("edit");

            var bank = document.getElementById("bank").value;
            var major = document.getElementById("major").value;
            var numbank = document.getElementById("numbank").value;
            var namebank = document.getElementById("namebank").value;
            //             var bankobject={
            //                 name: namebank,
            //               email: email,
            //               type: 'individual',
            //               bank_account: {
            //                 brand: bank,
            //                 number: numbank,
            //                 name: namebank

            //             }
            //             }

            // console.log(bankobject);

            //             var object = JSON.stringify(bankobject)


            db.collection("bank").where("shopid", "==", shopid).get()
                .then(function (querySnapshot) {

                    // doc.data() is never undefined for query doc snapshots
                    querySnapshot.docs.forEach(function (datas) {
                        var bankobject = {
                            recipentid: datas.data().recipentid,
                            name: namebank,
                            email: email,
                            type: 'individual',
                            bank_account: {
                                brand: bank,
                                number: numbank,
                                name: namebank

                            }
                        }

                        console.log(bankobject);

                        var object = JSON.stringify(bankobject)
                        $.ajax({
                            type: "POST",
                            url: "https://fierce-fortress-50416.herokuapp.com/recipent_edit",
                            data: object,
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            success: function (data) {
                                // console.log(data.data.id);
                                console.log(data);

                                //   console.log(data.id);

                                db.collection("bank").doc(datas.id).update({
                                    bank: bank,
                                    major: major,
                                    numbank: numbank,
                                    namebank: namebank,

                                    recipentid: data.data.id
                                });
                                checkbank();

                            },
                            error: function (data) {
                                // $("#cross").modal();
                                // storebike=[]
                                console.log(data);

                                alert("fail");
                            }
                        });

                    });
                    //showdetailshop()
                })
                .catch(function (error) {
                    console.log("Error getting documents: ", error);
                });

        }



                    // $("#elegantModalForm").modal();









                    // localStorage.clear();


    </script>
</body>

</html>